import{b as o}from"./chunk-3ESRGU4J.js";import{b as w,c as M,d as P}from"./chunk-DZ4QUUKD.js";var a=w(M());var e=w(P());function T({me:i,onSessionRefresh:u}){let[n,b]=(0,a.useState)("login"),[m,S]=(0,a.useState)(""),[p,_]=(0,a.useState)(""),[g,D]=(0,a.useState)(""),[f,E]=(0,a.useState)(""),[y,O]=(0,a.useState)(""),[N,v]=(0,a.useState)(i?.user?.birth_date||""),[x,C]=(0,a.useState)(i?.user?.full_name||""),[h,l]=(0,a.useState)(!1),[c,s]=(0,a.useState)(""),[d,r]=(0,a.useState)("");(0,a.useEffect)(()=>{i?.authenticated&&(C(i.user?.full_name||""),v(i.user?.birth_date||""))},[i]);let k=async()=>{l(!0),r(""),s("");try{await o("/api/auth/login/",{method:"POST",body:JSON.stringify({phone_number:m,password:p})}),await u(),s("Signed in successfully.")}catch(t){r(t.message)}finally{l(!1)}},A=async()=>{l(!0),r(""),s("");try{await o("/api/auth/register/",{method:"POST",body:JSON.stringify({phone_number:m,password:p,confirm_password:g,full_name:f,national_id:y})}),await u(),s("Registered and signed in successfully.")}catch(t){r(t.message)}finally{l(!1)}},F=async()=>{l(!0),r(""),s("");try{await o("/api/auth/profile/",{method:"PATCH",body:JSON.stringify({full_name:x,birth_date:N})}),await u(),s("Profile updated successfully.")}catch(t){r(t.message)}finally{l(!1)}},I=async()=>{l(!0),r(""),s("");try{await o("/api/auth/logout/",{method:"POST"}),await u(),b("login"),s("Signed out successfully.")}catch(t){r(t.message)}finally{l(!1)}};return i?.authenticated?(0,e.jsxs)("section",{className:"spa-card p-6 md:p-8",children:[(0,e.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,e.jsx)("h2",{className:"text-xl font-bold",children:"Account Profile"}),(0,e.jsx)("button",{type:"button",className:"btn btn-sm btn-outline border-white/30 text-white",onClick:I,disabled:h,children:"Logout"})]}),d?(0,e.jsx)("div",{className:"alert alert-error mb-3",children:d}):null,c?(0,e.jsx)("div",{className:"alert alert-success mb-3",children:c}):null,(0,e.jsxs)("div",{className:"space-y-3",children:[(0,e.jsx)("input",{className:"input input-bordered w-full bg-white/5 border-white/20 text-white",value:i.user?.phone_number||"",disabled:!0}),(0,e.jsx)("input",{className:"input input-bordered w-full bg-white/5 border-white/20 text-white",placeholder:"Full Name",value:x,onChange:t=>C(t.target.value)}),(0,e.jsx)("input",{className:"input input-bordered w-full bg-white/5 border-white/20 text-white",placeholder:"Birth Date (YYYY-MM-DD)",value:N,onChange:t=>v(t.target.value)}),(0,e.jsx)("button",{type:"button",className:"btn btn-primary w-full",onClick:F,disabled:h,children:"Save Profile"})]})]}):(0,e.jsxs)("section",{className:"spa-card p-6 md:p-8",children:[(0,e.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,e.jsx)("button",{type:"button",className:`btn btn-sm ${n==="login"?"btn-primary":"btn-outline border-white/30 text-white"}`,onClick:()=>b("login"),children:"Login"}),(0,e.jsx)("button",{type:"button",className:`btn btn-sm ${n==="register"?"btn-primary":"btn-outline border-white/30 text-white"}`,onClick:()=>b("register"),children:"Register"})]}),d?(0,e.jsx)("div",{className:"alert alert-error mb-3",children:d}):null,c?(0,e.jsx)("div",{className:"alert alert-success mb-3",children:c}):null,(0,e.jsxs)("div",{className:"space-y-3",children:[(0,e.jsx)("input",{className:"input input-bordered w-full bg-white/5 border-white/20 text-white",placeholder:"Phone Number (09xxxxxxxxx)",value:m,onChange:t=>S(t.target.value)}),(0,e.jsx)("input",{className:"input input-bordered w-full bg-white/5 border-white/20 text-white",type:"password",placeholder:"Password",value:p,onChange:t=>_(t.target.value)}),n==="register"?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("input",{className:"input input-bordered w-full bg-white/5 border-white/20 text-white",type:"password",placeholder:"Confirm Password",value:g,onChange:t=>D(t.target.value)}),(0,e.jsx)("input",{className:"input input-bordered w-full bg-white/5 border-white/20 text-white",placeholder:"Full Name",value:f,onChange:t=>E(t.target.value)}),(0,e.jsx)("input",{className:"input input-bordered w-full bg-white/5 border-white/20 text-white",placeholder:"National ID (optional)",value:y,onChange:t=>O(t.target.value)})]}):null,(0,e.jsx)("button",{type:"button",className:"btn btn-primary w-full",onClick:n==="login"?k:A,disabled:h,children:n==="login"?"Sign In":"Create Account"})]})]})}export{T as default};
