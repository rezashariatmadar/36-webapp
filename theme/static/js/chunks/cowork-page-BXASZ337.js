import{b as l}from"./chunk-3ESRGU4J.js";import{b as u,c as C,d as y}from"./chunk-DZ4QUUKD.js";var a=u(C());var t=u(y());function E({me:o}){let[N,f]=(0,a.useState)([]),[b,h]=(0,a.useState)([]),[n,x]=(0,a.useState)(""),[c,k]=(0,a.useState)("DAILY"),[r,S]=(0,a.useState)(""),[d,p]=(0,a.useState)(null),[g,m]=(0,a.useState)(!1),[w,i]=(0,a.useState)(""),_=async()=>{let e=await l("/api/cowork/spaces/");f(e.zones||[])},P=async()=>{if(!o.authenticated){h([]);return}let e=await l("/api/cowork/my-bookings/");h(e.bookings||[])},v=async()=>{m(!0),i("");try{await Promise.all([_(),P()])}catch(e){i(e.message)}finally{m(!1)}};(0,a.useEffect)(()=>{v()},[o.authenticated]);let Y=async()=>{if(!n||!r||!c){i("Select a space, booking type, and start date first.");return}i("");try{let e=new URLSearchParams({space_id:n,booking_type:c,start_time:r}),s=await l(`/api/cowork/bookings/preview/?${e.toString()}`);p(s)}catch(e){p(null),i(e.message)}},B=async()=>{if(!o.authenticated){window.location.assign(o.login_url||"/app/account");return}m(!0),i("");try{await l("/api/cowork/bookings/",{method:"POST",body:JSON.stringify({space_id:n,booking_type:c,start_time:r})}),p(null),await v()}catch(e){i(e.message)}finally{m(!1)}};return(0,t.jsxs)("section",{className:"spa-grid spa-grid-2",children:[(0,t.jsxs)("div",{className:"spa-card p-5 md:p-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("h2",{className:"text-xl font-bold",children:"Cowork Spaces"}),(0,t.jsx)("button",{type:"button",className:"btn btn-sm btn-outline border-white/30 text-white",onClick:v,disabled:g,children:"Refresh"})]}),w?(0,t.jsx)("div",{className:"alert alert-error mt-4",children:w}):null,(0,t.jsx)("div",{className:"mt-4 space-y-5",children:N.map(e=>(0,t.jsxs)("article",{children:[(0,t.jsx)("h3",{className:"font-semibold text-white/90 mb-2",children:e.label}),(0,t.jsx)("div",{className:"spa-grid md:grid-cols-2",children:(e.spaces||[]).map(s=>(0,t.jsxs)("button",{type:"button",className:`spa-card p-4 text-right transition-colors ${String(n)===String(s.id)?"border-primary":""}`,onClick:()=>x(String(s.id)),children:[(0,t.jsx)("div",{className:"font-medium",children:s.name}),(0,t.jsxs)("div",{className:"text-sm text-white/60 mt-1",children:["Status: ",s.status]}),(0,t.jsxs)("div",{className:"text-sm text-white/60",children:["Zone: ",s.zone]})]},s.id))})]},e.code))})]}),(0,t.jsxs)("aside",{className:"spa-grid",children:[(0,t.jsxs)("div",{className:"spa-card p-5",children:[(0,t.jsx)("h2",{className:"text-lg font-bold",children:"Booking Preview"}),(0,t.jsxs)("div",{className:"space-y-3 mt-3",children:[(0,t.jsxs)("label",{className:"form-control",children:[(0,t.jsx)("span",{className:"label-text text-white/70",children:"Booking Type"}),(0,t.jsxs)("select",{className:"select select-bordered bg-white/5 border-white/20 text-white",value:c,onChange:e=>k(e.target.value),children:[(0,t.jsx)("option",{value:"DAILY",children:"Daily"}),(0,t.jsx)("option",{value:"MONTHLY",children:"Monthly"}),(0,t.jsx)("option",{value:"SIX_MONTH",children:"Six-Month"}),(0,t.jsx)("option",{value:"YEARLY",children:"Yearly"})]})]}),(0,t.jsxs)("label",{className:"form-control",children:[(0,t.jsx)("span",{className:"label-text text-white/70",children:"Start Date (YYYY-MM-DD)"}),(0,t.jsx)("input",{className:"input input-bordered bg-white/5 border-white/20 text-white",value:r,onChange:e=>S(e.target.value),placeholder:"1404-12-01"})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("button",{type:"button",className:"btn btn-outline border-white/30 text-white flex-1",onClick:Y,children:"Preview"}),(0,t.jsx)("button",{type:"button",className:"btn btn-primary flex-1",onClick:B,disabled:g||!n,children:"Book"})]}),d?(0,t.jsxs)("div",{className:"spa-card p-3 text-sm",children:[(0,t.jsxs)("div",{children:["Price: ",d.price.toLocaleString()," toman"]}),(0,t.jsxs)("div",{children:["End Date: ",d.end_time]}),(0,t.jsxs)("div",{children:["Jalali End: ",d.end_time_jalali]})]}):null]})]}),(0,t.jsxs)("div",{className:"spa-card p-5",children:[(0,t.jsx)("h2",{className:"text-lg font-bold",children:"My Bookings"}),o.authenticated?(b||[]).length?(0,t.jsx)("div",{className:"mt-3 space-y-2",children:b.map(e=>(0,t.jsxs)("div",{className:"spa-card p-3 text-sm",children:[(0,t.jsx)("div",{className:"font-medium",children:e.space_name}),(0,t.jsxs)("div",{className:"text-white/70",children:[e.start_time," ","->"," ",e.end_time]}),(0,t.jsxs)("div",{className:"text-white/70",children:["Price: ",(e.price_charged||0).toLocaleString()," toman"]})]},e.id))}):(0,t.jsx)("p",{className:"text-sm text-white/60 mt-2",children:"No active bookings."}):(0,t.jsx)("p",{className:"text-sm text-white/60 mt-2",children:"Sign in to see your bookings."})]})]})]})}export{E as default};
