<div id="booking-preview" class="space-y-4 animate-in fade-in duration-300 relative">
    <div class="htmx-indicator absolute inset-0 bg-base-100/50 flex justify-center items-center z-10 rounded-2xl">
        <span class="loading loading-spinner text-primary"></span>
    </div>

    <!-- Summary Div (Dynamic) -->
    <div class="bg-base-200/50 rounded-2xl p-5 text-sm space-y-3 border border-base-300">
        <div class="flex justify-between items-center">
            <span class="opacity-70 italic">هزینه نهایی:</span>
            <!-- Added format-price class for JS formatting -->
            <span class="text-xl font-black text-primary format-price">{{ price|default:0 }}</span>
        </div>
        
        {% if calculated_end_jalali %}
        <div class="flex justify-between items-center pt-2 border-t border-base-300/50">
            <span class="opacity-70">تاریخ پایان:</span>
            <span class="font-bold text-secondary">{{ calculated_end_jalali }}</span>
        </div>
        {% endif %}

        {% if form.start_time.errors or form.non_field_errors %}
        <div class="text-error text-xs pt-2 border-t border-base-300/50">
            {{ form.start_time.errors|striptags }}
            {{ form.non_field_errors|striptags }}
        </div>
        {% endif %}
    </div>

    <!-- Hidden End Time Field (Updated via HTMX) -->
    <input type="hidden" name="end_time" value="{{ calculated_end|date:'Y-m-d'|default:'' }}">
</div>