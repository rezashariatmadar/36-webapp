<div id="item-control-{{ item.id }}" class="flex items-center justify-between gap-4 transition-all duration-300 w-full mt-4 bg-white/5 p-2 rounded-2xl border border-white/5">
    {# Signal the NAVBAR cart badge to update its count #}
    {% if request.htmx %}
    <span hx-swap-oob="true" id="cart-badge-desktop" class="badge badge-accent badge-xs font-black absolute -top-1 -right-1 {% if not cart_count %}hidden{% endif %}">
        {{ cart_count|default:0 }}
    </span>
    {% endif %}

    <div class="flex flex-col">
        <span class="text-xs font-bold text-white/40 mb-0.5">قیمت واحد</span>
        <div class="flex items-baseline gap-1">
            <span class="font-black text-accent text-lg">{{ item.price }}</span>
            <span class="text-[10px] text-white/60 font-bold">تومان</span>
        </div>
    </div>

    {% if quantity > 0 %}
        <div class="flex items-center bg-black/20 rounded-xl p-1 border border-white/10 shadow-lg backdrop-blur-md">
            <button hx-post="{% url 'cafe:remove_from_cart' item.id %}" 
                    hx-target="#item-control-{{ item.id }}" 
                    hx-swap="outerHTML"
                    class="btn btn-ghost h-10 w-10 md:h-9 md:w-9 btn-square text-white hover:bg-white/10 font-black text-lg">-</button>
            <span class="w-10 text-center font-black text-lg text-white">{{ quantity }}</span>
            <button hx-post="{% url 'cafe:add_to_cart' item.id %}" 
                    hx-target="#item-control-{{ item.id }}" 
                    hx-swap="outerHTML"
                    class="btn btn-ghost h-10 w-10 md:h-9 md:w-9 btn-square text-white hover:bg-white/10 font-black text-lg">+</button>
        </div>
    {% else %}
        <button hx-post="{% url 'cafe:add_to_cart' item.id %}" 
                hx-target="#item-control-{{ item.id }}" 
                hx-swap="outerHTML"
                class="btn-primary btn-sm md:btn-sm h-12 md:h-10 px-6 rounded-xl flex items-center gap-2 group shadow-lg shadow-accent/10">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 group-hover:scale-110 transition-transform" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M12 4v16m8-8H4" />
            </svg>
            <span class="font-black text-sm">افزودن</span>
        </button>
    {% endif %}
</div>
